<!DOCTYPE html>
<html lang="en">
<head>
<title>Fantasy Rumors</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {
  font-family: Arial, Helvetica, sans-serif;
}
</style>
</head>
<body>

<h1>Fantasy Rumors</h1>
<p>Randomly generated rumors</p>

<p id="demo"></p>
<button id="generateBtn">Generate Sentence</button>

<script>

const tables = {
    urban_place_adjective: ["charming", "gritty", "bustling"],
    urban_place: ["market", "alley", "square"],
    compass_direction: ["north", "south", "east", "west"],
    landmark: ["the cathedral", "the river", "the castle"],
    urban_location: ["${compass_direction} of ${landmark}"],
    urban_subjectplural: ["the merchants", "the performers", "the thieves"],
    urban_verbplural: ["shout", "dance", "haggle"],
    urban_subjectsingular: ["a street performer", "a pickpocket", "a monk"],
    urban_verbsingular: ["sings", "sneaks", "prays"],
    urban_subjectverb: [
        "${urban_subjectplural} ${urban_verbplural}",
        "${urban_subjectsingular} ${urban_verbsingular}"
    ],
    sentence: [
        "There's a ${urban_place_adjective} ${urban_place} ${urban_location}. It's said that here, ${urban_subjectverb}."
    ]
};

function resolve(template) {
    // If it's an array, pick a random entry and resolve it
    if (Array.isArray(template)) {
        return resolve(template[Math.floor(Math.random() * template.length)]);
    }

    // If it's a string with embedded parameters, resolve them recursively
    if (typeof template === "string") {
        return template.replace(/\$\{(\w+)\}/g, (_, key) => {
            const value = tables[key];
            if (!value) return `[undefined:${key}]`; // helpful for debugging
            return resolve(value);
        });
    }

    return template;
}
const output = resolve(tables["sentence"]);
console.log(output);
document.getElementById("demo").innerText = output;

function generateSentence() {
const output = resolve(tables["sentence"]);
console.log(output);
document.getElementById("demo").innerText = output;
console.log("call me maybe " + output);
}

 // Initial generation
    resolve();

    // Button click
    document.getElementById("generateBtn").addEventListener("click", generateSentence);


</script>

</body>
</html>